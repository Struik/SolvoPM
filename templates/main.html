{% extends "index.html" %}
{% load staticfiles %}

{% block extracss %}
<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/selectize.bootstrap3.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap-datetimepicker.css' %}"/>
{% endblock %}

{% block extrajs %}
<script>
    //Variable containing all cities with reference to countries which will be used in main.js
    //Django variables are only accessible inside the template and can be passed to external javascript only this way
    var cities = {};
    {% for query in projectAttrs.Cities %}
        if(cities['{{query.country.name}}'])
        {
            cities['{{query.country.name}}'].push({ 'id': '{{query.id}}', 'name': '{{query.name}}' })
        }
        else
        {
            cities['{{query.country.name}}']=[]
            cities['{{query.country.name}}'].push({ 'id': '{{query.id}}', 'name': '{{query.name}}' })
        }
    {% endfor %}

    var projectAttrs = '{{projectAttrs.Countries}}';
    console.log(cities);




</script>

<script src="{% static 'js/selectize.js' %}"></script>
<script src="{% static 'js/jquery.steps.js' %}"></script>
<script src="{% static 'js/jquery.validate.js' %}"></script>
<script src="{% static 'js/additional-methods.js' %}"></script>
<script src="{% static 'js/moment-with-locales.js' %}"></script>
<script src="{% static 'js/bootstrap-datetimepicker.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>
{% endblock %}


{% block page-header %}
{% endblock %}

{% block content %}
<div class="text-center">
    <div class="btn-group">
        <!-- Button trigger modal -->
        <button id="add" class="btn btn-xlg btn-default btn-ghost" data-toggle="modal" data-target="#myModal">Add
        </button>
        <button id="look" class="btn btn-xlg btn-default btn-ghost" onclick="location.href='projects';">Look</button>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <!--<div class="modal-header">-->

            <!--</div>-->
            <!--<div class="modal-body">-->

            <form id="projectAddForm" method="post">
                <h3>Description</h3>
                <!--<h3>Stages</h3>-->
                <h3>Contracts</h3>

                <section>
                    <div class="form-group">
                        <input type="text" class="form-control" id="projectName" name="projectName" value=""
                               placeholder="Project name">
                    </div>

                    <div class="alert alert-info alert-dismissible" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        Just start typing if you want to add new company, country or city
                    </div>

                    <div class="form-group">
                        <select class="form-control selectize" id="selectCompany" name="selectCompany"
                                placeholder="Select company" reference_id="Companies">
                            <option value="">Select a company</option>
                            {% for query in projectAttrs.Companies %}
                            <option value="{{query.id}}">{{query.name}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <select class="form-control selfselectized" id="selectCountry" name="selectCountry"
                                placeholder="Select a country" reference_id="Countries">
                            <option value="">Select a country</option>
                            {% for query in projectAttrs.Countries %}
                            <option value="{{query.id}}">{{query.name}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <select class="form-control selfselectized" id="selectCity" name="selectCity"
                                placeholder="Select a city" reference_id="Cities">
                            <option value="">Select a city</option>
                            {% for query in projectAttrs.Cities %}
                            <option value="{{query.id}}">{{query.name}}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <textarea class="form-control" id="Address" name="Address" rows="3"
                                  placeholder="Address"></textarea>
                    </div>
                </section>

                <!--<section>-->
                <!--<div class="form-group">-->
                <!--<select class="form-control" id="selectStage" name="selectStage" placeholder="Stage name"-->
                <!--reference_id="StageTypes">-->
                <!--<option value="">Stage name</option>-->
                <!--{% for query in projectAttrs.StageTypes %}-->
                <!--<option value="{{query.id}}">{{query.name}}</option>-->
                <!--{% endfor %}-->
                <!--</select>-->
                <!--</div>-->
                <!--&lt;!&ndash;Struik. For possible future use: in case of need for dynamic stage attributes&ndash;&gt;-->
                <!--&lt;!&ndash;div class="form-group">-->
                <!--<select class="form-control" id="selectAttribute" placeholder="Stage attribute">-->
                <!--<option value="">Stage attribute</option>-->
                <!--<option value="1">Cost</option>-->
                <!--<option value="2">Duration</option>-->
                <!--<option value="3">Payment</option>-->
                <!--</select>-->
                <!--</div&ndash;&gt;-->
                <!--<div class="form-group">-->
                <!--<input type="text" class="form-control stage-attr" id="cost" name="cost" placeholder="Cost">-->
                <!--</div>-->
                <!--<div class="form-group">-->
                <!--<input type="text" class="form-control stage-attr" id="duration" name="duration"-->
                <!--placeholder="Duration">-->
                <!--</div>-->
                <!--<div class="form-group">-->
                <!--<select class="form-control selectize fixed-values" id="selectPayment" name="selectPayment"-->
                <!--placeholder="Payment type">-->
                <!--<option value="">Payment type</option>-->
                <!--{% for query in projectAttrs.PaymentTypes %}-->
                <!--<option value="{{query.id}}">{{query.name}}</option>-->
                <!--{% endfor %}-->
                <!--</select>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                <!--<button id="addStage" type="button" class="btn btn-info">Add stage</button>-->
                <!--</div>-->
                <!--&lt;!&ndash;<div class="form-group">&ndash;&gt;-->
                <!--&lt;!&ndash;<div class="input-group">&ndash;&gt;-->
                <!--&lt;!&ndash;<span class="input-group-addon">$</span>&ndash;&gt;-->
                <!--&lt;!&ndash;<input type="text" class="form-control" placeholder="price">&ndash;&gt;-->
                <!--&lt;!&ndash;</div>&ndash;&gt;-->
                <!--&lt;!&ndash;</div>&ndash;&gt;-->
                <!--<div id="stagesList" class="form-group">-->
                <!--<label id="stageListLabel" class="control-label hidden">Stages list:</label>-->
                <!--</div>-->
                <!--</section>-->

                <section>
                    <div id="confirmPanel" class="panel panel-default">
                        <div class="panel-body">

                            <div class="form-group">
                                <select class="form-control selfselectized" id="selectContractType"
                                        name="selectContractType"
                                        placeholder="Contract type" reference_id="ContractTypes">
                                    <option value="">Contract type</option>
                                    {% for query in projectAttrs.ContractTypes %}
                                    <option value="{{query.id}}">{{query.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="form-group">
                                <input type="text" class="form-control contract-attr" id="contractName"
                                       name="contractName"
                                       value="" placeholder="Contract name" disabled>
                            </div>


                            <div class="form-group">
                                <label id="paymentsListLabel" class="control-label text-center hidden">Payments
                                    info</label>

                                <table id="paymentsTable" class="table table-condensed table-hover hidden">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Date</th>
                                        <th>Amount</th>
                                    </tr>
                                    </thead>
                                    <tbody id="paymentsTableBody">
                                    </tbody>
                                </table>
                            </div>

                            <div class="form-group">
                                <div class='input-group date' id='paymentDatePicker'>
                                    <input type="text" class="form-control datepicker payment-attr" id="paymentDate"
                                           name="paymentDate" placeholder="Payment date" disabled>
                                    <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar"></span>
                            </span>
                                </div>
                            </div>

                            <div class="form-group">
                                <input type="text" class="form-control payment-attr" id="paymentAmount"
                                       name="paymentAmount"
                                       placeholder="Payment amount" disabled>
                            </div>

                            <div class="form-group">
                                <button type="button" class="btn btn-success payment-attr btn-block" id="addPayment"
                                        disabled>Add
                                    payment
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <button id="addAnotherContract" type="button" class="btn btn-info  btn-block" disabled>Add
                            another contract
                        </button>
                    </div>

                </section>
            </form>

            <!--</div>-->
            <!--<div class="modal-footer">-->
            <!--</div>-->
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
</script>
{% endblock %}
