{% extends "index.html" %}
{% load staticfiles %}
{% load i18n %}

{% block extracss %}
<link rel="stylesheet" type="text/css" href="{% static 'css/dataTables.bootstrap.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/fixedColumns.bootstrap.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap-datetimepicker.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/projects.css' %}"/>
{% endblock %}

{% block extrajs %}
<script src="{% static 'js/jquery.steps.js' %}"></script>
<script src="{% static 'js/jquery.validate.js' %}"></script>
<script src="{% static 'js/validate.fix.js' %}"></script>
<script src="{% static 'js/datatables.js' %}"></script>
<script src="{% static 'js/dataTables.bootstrap.js' %}"></script>
<script src="{% static 'js/dataTables.rowsGroup.js' %}"></script>
<script src="{% static 'js/moment-with-locales.js' %}"></script>
<script src="{% static 'js/bootstrap-datetimepicker.js' %}"></script>
<script src="{% static 'js/projects.js' %}"></script>
{% endblock %}


{% block page-header %}Projects {% endblock %}

{% block content %}

<table id="projects" class="table table-bordered " cellspacing="0">
    <thead>
    <tr id="projectsHeaderFirst">
    </tr>
    <tr id="projectsHeaderSecond">
    </tr>
    </thead>
</table>


<div class="modal fade" id="infoModal" tabindex="-1" role="dialog">
    <!--modal-sm is redefined in projects.css to make it wider-->
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <form id="infoForm" enctype="multipart/form-data">
                <h3>{% trans "Month info" %}</h3>
                <h3>{% trans "Payment info" %}</h3>
                <h3>{% trans "Split payment info" %}</h3>
                <section>
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div id="monthInfo" class="form-group">
                                <table id="monthInfoTable" class="table table-condensed table-borderless">
                                    <thead>
                                    </thead>
                                    <tbody id="monthInfoTableBody">
                                    <tr>
                                        <td>{% trans "Project name" %}:</td>
                                        <td id="projectName"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Manager" %}:</td>
                                        <td id="manager"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Current state" %}:</td>
                                        <td id="currentState"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Contract type" %}:</td>
                                        <td id="contractType"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Contract name" %}:</td>
                                        <td id="contractName"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Planned" %}:</td>
                                        <td id="planned"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Confirmed" %}:</td>
                                        <td id="confirmed"></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="form-group">
                                <table id="paymentsTable" class="table table-condensed">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>{% trans "Amount" %}</th>
                                        <th>{% trans "Planned" %}</th>
                                        <th>{% trans "Confirmed" %}</th>
                                        <th></th>
                                    </tr>
                                    </thead>
                                    <tbody id="paymentsTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="alert alert-success confirmed-alert hidden" role="alert">{% trans "Payment is" %}
                        <strong>{% trans "confirmed" %}.</strong>
                        {% trans "You may only unconfirm it" %}
                    </div>

                    <div class="alert alert-info postponed-alert hidden" role="alert">{% trans "Payment is" %}
                        <strong>{% trans "postponed" %} </strong>{% trans "from" %} <em id="initialDate"></em><br/>
                        {% trans "Authority" %} - <a id="downloadPostponeAgreement" href="" class="alert-link"></a>
                    </div>

                    <div class="alert alert-warning inherited-alert hidden" role="alert">{% trans "Payment is" %}
                        {% trans "inherited from" %}
                        <a href="#" class="alert-link show-split-payment">{% trans "this one" %}</a><br/>
                        {% trans "Authority" %} - <u><a id="downloadSplitAgreement" href="" class="alert-link"></a></u>
                    </div>

                    <div class="alert alert-danger canceled-alert hidden" role="alert">{% trans "Payment is" %}
                        <strong>{% trans "canceled" %}. </strong>{% trans "No actions available" %}<br/>
                        {% trans "Authority" %} - <u><a id="downloadCancelAgreement" href="" class="alert-link"></a></u>
                    </div>

                    <div id="paymentInfoPanel" class="panel panel-default">
                        <div class="panel-body">
                            <div id="paymentInfo" class="form-group" style="margin-bottom: 5px;">
                                <table id="paymentInfoTable"
                                       class="table table-condensed table-borderless no-margin-bottom">
                                    <thead>
                                    </thead>
                                    <tbody id="paymentInfoTableBody">
                                    <tr>
                                        <td>{% trans "Amount" %}:</td>
                                        <td id="paymentInfoAmount"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Planned" %}:</td>
                                        <td id="paymentInfoPlanned"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Confirmed" %}:</td>
                                        <td id="paymentInfoConfirmed"></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="form-group unconfirm-action">
                                <button type="button" class="btn btn-warning btn-block"
                                        id="unconfirmPayment">
                                    {% trans "Unconfirm payment" %}
                                </button>
                            </div>

                        </div>
                    </div>

                    <div class="panel-group" id="actions">

                        <div class="panel panel-default confirm-panel">
                            <div class="panel-heading">
                                <h3 class="panel-title text-center"><a id="panel-confirm-title" data-toggle="collapse"
                                                                       data-parent="#actions" href="#collapse-confirm">
                                    {% trans "Confirm" %}</a>
                                </h3>
                            </div>
                            <div id="collapse-confirm" class="panel-collapse collapse">
                                <div class="panel-body">

                                    <div class="form-group confirm-action">
                                        <div class='input-group date' id='confirmDatePicker'>
                                            <input type="text" class="form-control datepicker"
                                                   id="confirmDate"
                                                   name="confirmDate" placeholder="Payment date">
                                            <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                                        </div>
                                    </div>

                                    <div class="form-group confirm-action">
                                        <button type="button" class="btn btn-success btn-block" id="confirmPayment">
                                            {% trans "Confirm payment" %}
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="panel panel-default postpone-panel">
                            <div class="panel-heading">
                                <h3 class="panel-title text-center"><a data-toggle="collapse" data-parent="#actions"
                                                               href="#collapse-postpone">{% trans "Postpone" %} </a>
                                </h3>
                            </div>
                            <div id="collapse-postpone" class="panel-collapse collapse">
                                <div class="panel-body">

                                    <div class="form-group">
                                        <div class="input-group">
                                            <input id="postponefileName" name="postponefileName" type="text"
                                                   class="form-control fileinput" readonly="">
                                            <label class="input-group-btn">
                                                    <span class="btn btn-primary">
                                                        Browse… <input type="file" name="document"
                                                                       style="display: none;">
                                                    </span>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <input type="text" class="form-control payment-attr" id="postponeDocumentName"
                                               name="postponeDocumentName"
                                               placeholder="{% trans 'Document name' %}">
                                    </div>

                                    <div class="form-group">
                                        <div class='input-group date' id='postponeDatePicker'>
                                            <input type="text" class="form-control datepicker"
                                                   id="postponePaymentDate"
                                                   name="postponePaymentDate" placeholder="{% trans 'Payment date' %}">
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <button type="button" class="btn btn-success btn-block" id="postponePayment">
                                            {% trans "Postpone payment" %}
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="panel panel-default split-panel">
                            <div class="panel-heading">
                                <h3 class="panel-title text-center"><a data-toggle="collapse" data-parent="#actions"
                                                                       href="#collapse-split">{% trans "Split" %}
                                </a></h3>
                            </div>
                            <div id="collapse-split" class="panel-collapse collapse">
                                <div class="panel-body">


                                    <div class="form-group">
                                        <div class="input-group">
                                            <input id="splitFileName" name="splitFileName" type="text"
                                                   class="form-control fileinput" readonly="">
                                            <label class="input-group-btn">
                                                    <span class="btn btn-primary">
                                                        Browse… <input type="file" name="document"
                                                                       style="display: none;">
                                                    </span>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <input type="text" class="form-control payment-attr" id="splitDocumentName"
                                               name="splitDocumentName"
                                               placeholder="{% trans 'Document name' %}">
                                    </div>

                                    <div class="form-group">
                                        <label id="childPaymentsListLabel" class="control-label text-center hidden">
                                            {% trans "Payments info" %}</label>

                                        <table id="childPaymentsTable"
                                               class="table table-condensed table-hover hidden">
                                            <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>{% trans "Amount" %}</th>
                                                <th>{% trans "Date" %}</th>
                                            </tr>
                                            </thead>
                                            <tbody id="childPaymentsTableBody">
                                            </tbody>
                                            <tfoot>
                                            <tr>
                                                <td><p class="pull-right">Total: </p></td>
                                                <td><p id="childPaymentSum" name="childPaymentSum"/></td>
                                                <td/>
                                            </tr>
                                            </tfoot>
                                        </table>
                                        <div class="alert alert-danger sum-alert hidden" role="alert">Child payment's
                                            sum is <strong>less</strong> than initial amount
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class='input-group date' id='splitDatePicker'>
                                            <input type="text" class="form-control datepicker"
                                                   id="childPaymentDate"
                                                   name="childPaymentDate" placeholder="{% trans 'Payment date' %}">
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <input type="text" class="form-control payment-attr" id="childPaymentAmount"
                                               name="childPaymentAmount"
                                               placeholder="{% trans 'Payment amount' %}">
                                    </div>

                                    <!--<div class="form-group">-->
                                    <!--<input type="text" class="form-control payment-attr" id="splitPaymentsum"-->
                                    <!--name="splitPaymentsum"-->
                                    <!--placeholder="Payments sum">-->
                                    <!--</div>-->

                                    <div class="form-group">
                                        <button type="button" class="btn btn-success btn-block" id="addPayment">
                                            {% trans "Add payment" %}
                                        </button>
                                    </div>

                                    <div class="form-group">
                                        <button type="button" class="btn btn-info btn-block" id="save">
                                            {% trans "Save" %}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="panel panel-default cancel-panel">
                            <div class="panel-heading">
                                <h3 class="panel-title text-center"><a data-toggle="collapse" data-parent="#actions"
                                                               href="#collapse-cancel">{% trans "Cancel payment" %}</a>
                                </h3>
                            </div>
                            <div id="collapse-cancel" class="panel-collapse collapse">
                                <div class="panel-body">

                                    <div class="form-group">
                                        <div class="input-group">
                                            <input id="cancelfileName" name="cancelfileName" type="text"
                                                   class="form-control fileinput" readonly="">
                                            <label class="input-group-btn">
                                                    <span class="btn btn-primary">
                                                        Browse… <input type="file" name="document"
                                                                       style="display: none;">
                                                    </span>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <input type="text" class="form-control payment-attr" id="cancelDocumentName"
                                               name="cancelDocumentName"
                                               placeholder="{% trans 'Document name' %}">
                                    </div>

                                    <div class="form-group">
                                        <button type="button" class="btn btn-success btn-block" id="cancelPayment">
                                            {% trans "Cancel payment" %}
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </section>

                <section>
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div id="splitPaymentInfo" class="form-group" style="margin-bottom: 5px;">
                                <table id="splitPaymentInfoTable"
                                       class="table table-condensed table-borderless no-margin-bottom">
                                    <thead>
                                    </thead>
                                    <tbody id="splitPaymentInfoTableBody">
                                    <tr>
                                        <td>{% trans "Amount" %}:</td>
                                        <td id="splitPaymentInfoAmount"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Planned" %}:</td>
                                        <td id="splitPaymentInfoPlanned"></td>
                                    </tr>
                                    <tr>
                                        <td>{% trans "Document name" %}:</td>
                                        <td><a id="splitPaymentInfoDocument" href=""></a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="form-group">
                                <table id="splitPaymentChildsTable" class="table table-condensed">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>{% trans "Amount" %}</th>
                                        <th>{% trans "Planned" %}</th>
                                        <th></th>
                                    </tr>
                                    </thead>
                                    <tbody id="splitPaymentChildsTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block script %}
<script>
</script>
{% endblock %}